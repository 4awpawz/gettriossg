<!DOCTYPE html>
<html lang="en">

<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-67538650-3"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());
        gtag('config', 'UA-67538650-3');
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta http-equiv="Cache-control" content="no-cache">
    <meta name="description" content="Trio is an open source toolkit for building static websites using HTML, CSS and JavaScript and requires almost zero configuration. You use front matter, JavaScript and Sass to quickly prototype and implement your designs, which makes Trio the perfect tool for those who love to design in the browser.">
    <meta name="author" content="Jeffrey Schwartz">
    <meta name="generator" content="Trio v1.0.0-rc.1">
    <title>Tag-Based Callbacks - Trio</title>
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.png">
    <link href="https://fonts.googleapis.com/css?family=Lora|Open+Sans" rel="stylesheet">
    <link rel="stylesheet" href="/css/libs/highlight/github.bf6c14925e66edb1526b6c9489b3c042.css">
    <link rel="stylesheet" href="/css/main.87f6903d3eb02a1b10230cdfefc8baea.css">
    <script src="/scripts/highlight.pack.e497281e462342b50ccbb59b462856dd.js"></script>
    <script>
        hljs.initHighlightingOnLoad();
    </script>
</head>

<body>
    <header class="header header--fixed header--green">
        <section class="container header__container">
            <input class="hamburger-checkbox header__hamburger-checkbox" type="checkbox" id="hamburger-checkbox" autocomplete="off">
            <label class="hamburger-helper header__hamburger-container" for="hamburger-checkbox">
                <div class="hamburger">
                    <div class="hamburger__bun">
                        <div class="hamburger__patty"></div>
                        <div class="hamburger__patty"></div>
                        <div class="hamburger__patty"></div>
                    </div>
                </div>
            </label>
            <div class="header__promo">
                <img class="header__promo-image" src="/media/brand.b66d421676dcc7ac68959fd41c82c140.svg" alt="Trio Icon">
                <div class="header__promo-text">Trio
                    <span class="header__promo-text-version">v1.0.0-rc.1</span>
                    <span class="header__promo-text-version-name">(Ikigai)</span>
                </div>
            </div>
            <nav class="header__nav">
                <ul class="header__nav-items">
                    <li class="header__nav-item">
                        <a class="header__nav-item-link" href="/">Home</a>
                    </li>
                    <li class="header__nav-item header__nav-item--active">
                        <a class="header__nav-item-link" href="/docs/v1/">Docs</a>
                    </li>

                    <li class="header__nav-item">
                        <a class="header__nav-item-link" target="_blank" href="/blog">Blog</a>
                    </li>
                </ul>
            </nav>
        </section>
    </header>
    <main class="container doc-page">
        <aside class="doc-page-index">
            <section class="doc-page-index__container">
                <h2 class="doc-page-index__container-header">Trio <span class="doc-page-index__container-header-version">v1.0.0-rc.1</span></h2>

                <aside class="doc-page-index__list-container">
                    <ul class="doc-page-index__list">
                        <li class="doc-page-index__list-item">
                            <a class="doc-page-index__list-item-link" href="/docs/v1">About</a>
                        </li>
                        <li class="doc-page-index__list-item">
                            <a class="doc-page-index__list-item-link" href="/docs/v1/gettingstarted">Getting
                                Started</a>
                        </li>
                        <li class="doc-page-index__list-item">
                            <a class="doc-page-index__list-item-link" href="/docs/v1/keyconcepts">Key
                                Concepts</a>
                        </li>

                        <li class="doc-page-index__list-item">
                            <a class="doc-page-index__list-item-link" href="/docs/v1/projectstructure">Project Structure</a>
                        </li>
                        <li class="doc-page-index__list-item">
                            <a class="doc-page-index__list-item-link" href="/docs/v1/pagegeneration">Page Generation</a>
                        </li>
                        <li class="doc-page-index__list-item">
                            <a class="doc-page-index__list-item-link" href="/docs/v1/frontmatter">Front Matter</a>
                        </li>
                        <li class="doc-page-index__list-item">
                            <a class="doc-page-index__list-item-link" href="/docs/v1/tagattributes">Tag Attributes</a>
                        </li>
                        <li class="doc-page-index__list-item">
                            <a class="doc-page-index__list-item-link" href="/docs/v1/template">Template</a>
                        </li>
                        <li class="doc-page-index__list-item">
                            <a class="doc-page-index__list-item-link" href="/docs/v1/fragment">Fragment</a>
                        </li>
                        <li class="doc-page-index__list-item">
                            <a class="doc-page-index__list-item-link" href="/docs/v1/include">Include</a>
                        </li>
                        <li class="doc-page-index__list-item">
                            <a class="doc-page-index__list-item-link" href="/docs/v1/jsondata">JSON Data</a></li>
                        <li class="doc-page-index__list-item">
                            <a class="doc-page-index__list-item-link" href="/docs/v1/metadata">Metadata</a></li>
                        <li class="doc-page-index__list-item">
                            <a class="doc-page-index__list-item-link doc-page-index__list-item-link--current" href="/docs/v1/tagbasedcallbacks">Tag-Based Callbacks</a>
                        </li>
                        <li class="doc-page-index__list-item">
                            <a class="doc-page-index__list-item-link" href="/docs/v1/scsssasscss">SCSS/SASS/CSS</a>
                        </li>
                        <li class="doc-page-index__list-item">
                            <a class="doc-page-index__list-item-link" href="/docs/v1/blogging">Blogging</a>
                        </li>
                        <li class="doc-page-index__list-item">
                            <a class="doc-page-index__list-item-link" href="/docs/v1/commandline">Command Line</a>
                        </li>
                        <li class="doc-page-index__list-item">
                            <a class="doc-page-index__list-item-link" href="/docs/v1/incrementalbuild">Incremental Build</a>
                        </li>
                        <li class="doc-page-index__list-item">
                            <a class="doc-page-index__list-item-link" href="/docs/v1/configuration">Configuration</a>
                        </li>
                    </ul>

                </aside>
            </section>
        </aside>
        <article class="doc-page-content">
            <section class="notification">Documentation is evolving and is a WIP</section>
            <section class="doc-page-content__copy">
                <h1>Tag-Based Callbacks</h1>

                <p>Trio scans your composites for tags decorated with the <em>data-trio-callback</em> attribute and calls the modules they name in the root/source/callbacks folder <em>asynchronously</em> with a single object whose properties can be used along with cheerio to manipulate the composite <em>as if you were actually using jQuery to manipulate the DOM</em>.</p>

                <p><mark>Internally Trio treats all you assets&apos; markup as simple text, and parses it using jQuery-like selector syntax using the awesome OS library called <a class="doc-page__decorated-link" target="_blank" href="https://www.npmjs.com/package/cheerio"><em>cheerio</em></a>. If you have ever used jQuery then you should already know how to use cheerio&apos;s selector syntax. If you have never used jQuery then you can learn its selector syntax by visiting <a href="https://jquery.com/">jquery.com</a>.</mark></p>

                <figure>
                    <pre><code class="JavaScript">/*
moduleDependencies: ./lib/capitalize
*/
const capitalize = require(&quot;./lib/capitalize&quot;);

module.exports = ({ $tag, site }) =&gt; {
    site.articlesCount &amp;&amp; site.articlesCatalog.forEach(item =&gt; {
        const data = item.matter.data;
        $tag.append(`
                &lt;li&gt;
                    &lt;a data-trio-link href=&quot;${item.url}&quot;&gt;
                        ${data.title} - Posted to ${capitalize(data.category[0])} - ${item.articleDate}
                    &lt;/a&gt;
                &lt;/li&gt;
            `);
    });
};</code></pre>
                    <figcaption>Tag-based callback Example</figcaption>
                </figure>

                <ul>
                    <li><strong>file location</strong>: root/source/callbacks</li>
                    <li><strong>file type/content</strong>: .js/JavaScript</li>
                </ul>

                <h2>Declaring Tag-Based Callbacks</h2>

                <p>Declaring a tag-based callback is as simple as picking any tag in a template, fragment or include asset and decorating it with the <em>data-trio-callback</em> attribute and assigning it the name of a callback in the <em>root/source/callbacks</em> folder:</p>

                <figure>
                    <pre><code class="html">&lt;ul data-trio-callback=&quot;blogtaglist&quot;&gt;&lt;/ul&gt;</code></pre>
                    <figcaption>Declaring A Tag-based callback Example</figcaption>
                </figure>

                <h2>Implementing Callbacks</h2>

                <p>Each module must export a single function which, when called by Trio, is passed a single argument which can be destructured to access its properties.</p>

                <p>Callbacks can be implemented to run <em>synchronously</em></p>

                <figure>
                    <pre><code class="js">module.exports = ({ $tag, site }) =&gt; {
    site.tagsCatalog.forEach(item =&gt; {
        $tag.append(`
            &lt;li class=&quot;tag__list-item&quot;&gt;
                &lt;a data-trio-link class=&quot;tag__list-item-link&quot;
                href=&quot;/blog/tag/${item.tag.toLowerCase()}&quot;&gt;${item.tag}&lt;/a&gt;
            &lt;/li&gt;
        `);
    });
};</code></pre>
                    <figcaption>Synchronous JavaScript Callback Example</figcaption>
                </figure>

                <p>or <em>asynchronously</em>, using async/await.</p>

                <figure>
                    <pre><code class="js">module.exports = async ({ $tag, site }) =&gt; {
    const catalog = await getCatalogFromCloud(...);
    catalog.forEach(item =&gt; {
        $tag.append(`
            &lt;li class=&quot;catalog-item__list-item&quot;&gt;
                &lt;a data-trio-link class=&quot;catalog-item__list-item-link&quot;
                href=&quot;/catalog/item/${item.name}&quot;&gt;${item.price.toFixed(2)}&lt;/a&gt;
            &lt;/li&gt;
        `)
    });
};</code></pre>
                    <figcaption>Asynchronous JavaScript Callback Example</figcaption>
                </figure>

                <h2>Argument Properties</h2>

                <h3>$</h3>
                <p>A <em>cheerio wrapper</em> around the composite. Use when targeting the composite&apos;s content.</p>
                <figure>
                    <pre><code class="js">module.exports = ({ $, site }) =&gt; {
    site.tagsCatalog.forEach(item =&gt; {
        $.find(&quot;ul.tag__list&quot;).append(`
            &lt;li class=&quot;tag__list-item&quot;&gt;
                &lt;a data-trio-link class=&quot;tag__list-item-link&quot;
                href=&quot;/blog/tag/${item.tag.toLowerCase()}&quot;&gt;${item.tag}&lt;/a&gt;
            &lt;/li&gt;
        `);
    });
    $.find(&quot;div.page-modified-date&quot;).append(new Date().toDateString());
};</code></pre>
                    <figcaption>Targeting A Composite&apos;s Content Using $tag Example</figcaption>
                </figure>

                <h3>$tag</h3>
                <p>A <em>cheerio wrapper</em> around the tag. Use when targeting the tag and its content.</p>
                <figure>
                    <pre><code class="js">module.exports = ({ $tag }) =&gt; {
    $tag.append(new Date().toDateString());
};</code></pre>
                    <figcaption>Targeting A Tag&apos;s Content Using $tag Example</figcaption>
                </figure>

                <h3>site</h3>
                <p>Contains the complete collection of metadata</p>
                <figure>
                    <pre><code class="js">module.exports = ({ $tag, site }) =&gt; {
    site.tagsCatalog.forEach(item =&gt; {
        $tag.append(`
            &lt;li class=&quot;tag__list-item&quot;&gt;
                &lt;a data-trio-link class=&quot;tag__list-item-link&quot;
                href=&quot;/blog/tag/${item.tag.toLowerCase()}&quot;&gt;${item.tag}&lt;/a&gt;
            &lt;/li&gt;
        `);
    });
};</code></pre>
                    <figcaption>Targeting A Tag&apos;s Content Using $tag Example</figcaption>
                </figure>

                <h3>asset</h3>
                <p>Contains the fragment&apos;s metadata.</p>
                <figure>
                    <pre><code class="js">module.exports = ({ $tag, asset }) =&gt; {
    const data = asset.matter.data;
    $tag.find(&quot;h1.article__title&quot;).append(data.title);
    $tag.find(&quot;span.article__category&quot;).append(`&quot;${data.category}&quot;`);
    $tag.find(&quot;span.article__date&quot;).append(asset.articleDate);
    $tag.find(&quot;img.article__img&quot;).attr(&quot;src&quot;, `/media/${asset.matter.data.image}`);
};</code></pre>
                    <figcaption>Targeting A Tag&apos;s Content Using $tag Example</figcaption>
                </figure>

                <h2 id="declaringinternaldependencies">Declaring Internal Dependencies To Trigger Incremental Builds</h2>

                <p>When using incremental build, Trio will detect that you have made modifications to your tag-based callbacks, and it will trigger a build to regenerate only those composites whose assets relate by way of their chains of dependencies to the modified callback. However, Trio will not automatically trigger a build when:</p>

                <ul>
                    <li> it detects that you have made modifications to modules that your tag-based callbacks might requires, such as to a library that you created in root/source/callbacks/lib</li>
                    <li> it detects that you have made modifications to JSON files in the root/source/data folder that your tag-based callbacks might require</li>
                </ul>

                <p>To remedy these 2 situations, you can optionally add front matter to your tag-based callbacks, and include in them the properties discussed below, that will inform Trio to trigger a build whenever these internal dependencies are modified.</p>

                <h3>Declaring Your Module Dependencies</h3>
                <p>Declare your module dependencies using the <mark>moduleDependencies</mark> property.</p>
                <figure>
                    <pre><code class="js">/*
moduleDependencies:
- ./lib/getDate
- ./lib/getTime
*/</code></pre>
                    <figcaption>Declaring Module Dependencies Example</figcaption>
                </figure>

                <h3>Declaring Your JSON Data File Dependencies</h3>
                <p>Declare your JSON file dependencies using the <mark>dataDependencies</mark> property.</p>
                <figure>
                    <pre><code class="js">/*
dataDependencies:
- contactInfo
- portfolio
*/</code></pre>
                    <figcaption>Declaring JSON File Dependencies Example</figcaption>
                </figure>

                <h2 id="declaringexternaldependencies">Declaring External Dependencies On Metadata To Trigger Incremental Builds</h2>

                <p>When using incremental build, Trio will detect that you have made modifications to your fragment, include, template and tag-based callback assets, and it will trigger a build to regenerate only those composites whose assets relate by way of their chains of dependencies to those modified assets. However, Trio will not regenerate composites whose own assets haven&apos;t changed but which consume the metadata generated from modified assets unrelated to these composites, such as when generating pages that contain lists of other pages (e.g. blog pages, tag pages, category pages, catalog pages, portfolio pages, etc.).</p>

                <p>To remedy this situation, you can add the front matter <em>alwaysBuild</em> property to your fragment&apos;s front matter, which will cause Trio to always regenerate the composite related to the fragment.</p>

                <figure>
                    <pre><code class="html">&lt;!--
template: blogpage.html
title: Trio Blog | Official blog for Trio static site generator.
alwaysBuild: true
--&gt;</code></pre>
                    <figcaption>Using The Front Matter alwaysBuild Property Example</figcaption>
                </figure>
                <h2>See Also</h2>

                <ul>
                    <li><a href="/docs/v1/fragment">Fragment</a></li>
                    <li><a href="/docs/v1/tagattributes">Tag Attributes</a></li>
                    <li><a href="/docs/v1/frontmatter">Front Matter</a></li>
                    <li><a href="/docs/v1/metadata">Metadata</a></li>
                    <li><a href="/docs/v1/incrementalbuild">Incremental Build</a></li>
                    <li><a target="_blank" href="https://www.npmjs.com/package/cheerio">cheerio</a></li>
                </ul>
            </section>
            <footer class="doc-page-content__footer">
                <section class="doc-page-content__footer-container">
                    <p>Created by <a target="_blank" href="https://twitter.com/jefftschwartz"> <strong>@jefftschwartz</strong></a></p>
                    <p>with <span class="footer__heart">&#x2665;</span> for the Web and passion for simplifying complex things.</p>
                    <p>&#xA9;2018 Jeffrey Schwartz All Rights Reserved.</p>
                    <p>Code licensed <a target="_blank" href="https://github.com/4awpawz/trio/blob/master/LICENSE">MIT</a>, docs <a target="_blank" href="https://creativecommons.org/licenses/by/3.0/">CC By 3.0</a>.</p>
                    <p>Built with <a target="_blank" href="https://github.com/4awpawz/trio/tree/master#changelog">
                            <strong>Trio <span>v1.0.0-rc.1</span></strong></a>.</p>
                    <p>Page Updated: <span>6/24/2019, 5:16:27 PM.</span> </p>
                </section>
            </footer>
        </article>
    </main>

</body>

</html>